(function(i,s){typeof exports=="object"&&typeof module!="undefined"?s(exports,require("fourdom")):typeof define=="function"&&define.amd?define(["exports","fourdom"],s):(i=typeof globalThis!="undefined"?globalThis:i||self,s(i.Starscore={},i.fourdom))})(this,function(i,s){"use strict";var v=Object.defineProperty;var m=(i,s,o)=>s in i?v(i,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[s]=o;var h=(i,s,o)=>(m(i,typeof s!="symbol"?s+"":s,o),o);var o=(n=>(n.containerClassName="starscore-container",n.scoreWrapperClassName="starscore-radio-group",n.scoreItemClassName="starscore-radio",n.scoreIconClassName="starscore-radio__icon",n.scoreVoidIconClassName="starscore-radio__void-icon",n))(o||{});const l=n=>typeof n=="number"?`${n}px`:n,d={star:{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="1em" class="icon" viewBox="0 0 1024 1024" fill="#FFA900" style="--svg-origin-width:200;--svg-origin-height:200;--svg-origin-width--with-unit:200px;--svg-origin-height--with-unit:200px;" data-svg-origin-width="200" data-svg-origin-height="200" font-size="200"><path d="M270.336 978.944c-57.344 29.696-95.232 3.072-83.968-61.44l46.08-268.288-194.56-190.464c-46.08-45.056-31.744-89.088 31.744-99.328l269.312-38.912L459.776 76.8c28.672-58.368 74.752-58.368 104.448 0l120.832 244.736 269.312 38.912c64.512 9.216 78.848 53.248 31.744 99.328l-194.56 189.44 46.08 268.288c11.264 63.488-26.624 91.136-83.968 61.44L512 851.968 270.336 978.944z"/></svg>',voidIcon:'<svg xmlns="http://www.w3.org/2000/svg" width="1em" class="icon" viewBox="0 0 1024 1024" style="--svg-origin-width:200;--svg-origin-height:200;--svg-origin-width--with-unit:200px;--svg-origin-height--with-unit:200px;" data-svg-origin-width="200" data-svg-origin-height="200" font-size="200"><path d="m512 111.616 130.048 263.623 290.93 42.211-210.489 205.255 49.721 289.678L512 775.622 251.79 912.383l49.721-289.678L91.022 417.45l290.93-42.211L512 111.616m0-72.818a72.721 72.721 0 0 0-65.309 40.619L333.596 308.679l-253.042 36.75c-27.421 3.982-50.176 23.211-58.823 49.607a72.957 72.957 0 0 0 18.432 74.638l183.069 178.403-43.235 252.018c-4.665 27.307 6.599 54.955 29.013 71.225 12.629 9.216 27.762 13.881 42.781 13.881 11.605 0 23.211-2.731 33.906-8.419l226.304-118.898 226.304 119.011c10.695 5.575 22.301 8.419 33.906 8.419 15.133 0 30.151-4.665 42.781-13.881 22.414-16.27 33.678-43.918 29.013-71.225L800.77 648.19l183.069-178.403c19.797-19.342 26.965-48.242 18.432-74.638s-31.403-45.625-58.823-49.607l-253.042-36.75L577.311 79.53c-12.288-25.031-37.547-40.733-65.309-40.733z"/></svg>'},heart:{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="1em" class="icon" viewBox="0 0 1024 1024" style="--svg-origin-width:200;--svg-origin-height:200;--svg-origin-width--with-unit:200px;--svg-origin-height--with-unit:200px;" data-svg-origin-width="200" data-svg-origin-height="200" font-size="200"><path d="M1024 352c0 337-512 592-512 592S0 690 0 352C0 201.8 121.8 80 272 80c101.3 0 189.7 55.4 236.5 137.6 1.5 2.7 5.4 2.7 6.9 0C562.3 135.4 650.7 80 752 80c150.2 0 272 121.8 272 272z"/></svg>',voidIcon:'<svg xmlns="http://www.w3.org/2000/svg" width="1em" class="icon" viewBox="0 0 1024 1024" style="--svg-origin-width:200;--svg-origin-height:200;--svg-origin-width--with-unit:200px;--svg-origin-height--with-unit:200px;" data-svg-origin-width="200" data-svg-origin-height="200" font-size="200"><path d="M752 144c55.6 0 107.8 21.6 147.1 60.9S960 296.4 960 352c0 32.7-6.1 66.4-18.1 100.2-11.4 32-28.3 64.9-50.3 97.8-38.7 57.8-93.4 116.2-162.5 173.6C643 795.1 555.6 847.2 512 871.5c-43.2-24-129.4-75.1-215.2-146-69.6-57.5-124.6-116-163.7-174-22.2-33.1-39.3-66.1-50.8-98.4C70.2 418.9 64 385 64 352c0-55.6 21.6-107.8 60.9-147.1S216.4 144 272 144c76.9 0 147.2 42.2 183.6 110.1l28.2 52.7c12.1 22.5 44.4 22.5 56.4 0l28.2-52.7C604.8 186.2 675.1 144 752 144zm0-64c-101.3 0-189.7 55.4-236.5 137.6-1.5 2.7-5.4 2.7-6.9 0C461.7 135.4 373.3 80 272 80 121.8 80 0 201.8 0 352c0 338 512 592 512 592s512-255 512-592c0-150.2-121.8-272-272-272z"/></svg>'}};class g{constructor(t){h(this,"options",{container:"",count:5,initialValue:0,size:"20px",gutter:"4px",color:"#ee0a24",voidColor:"#c8c9cc",disabledColor:"#c8c9cc",icon:"",type:"star",voidIcon:"",clearable:!0,readonly:!1,disabled:!1,allowHalf:!1,scoreDetails:[{score:1,description:""},{score:2,description:""},{score:3,description:""},{score:4,description:""},{score:5,description:""}],onChange:()=>{}});h(this,"container",null);h(this,"value",0);this.options=Object.assign(this.options,t),this.value=this.options.initialValue,this.clickListener=this.clickListener.bind(this),this.initCSSVars(),this.render()}setValue(t){return t<0?this.value=0:t>this.options.count?this.value=this.options.count:this.value=t,this.render(),this}getValue(){return this.value}setOptions(t,e){return this.options=Object.assign(this.options,t),e&&(this.initCSSVars(),this.render()),this}getIcon(){return this.options.icon?this.options.icon:d[this.options.type].icon}getVoidIcon(){return this.options.voidIcon?this.options.voidIcon:d[this.options.type].voidIcon}get scoreItems(){const t=[];for(let e=1;e<=this.options.count;e++){const a=e-this.value,r=this.value>=e?1:a>=1?0:Number.parseFloat((1-a).toFixed(1));t.push({score:e,active:this.value>=e,proportion:r,width:`${r*100}%`})}return t}getScoreItemFromChild(t){return t.dataset.score?t:t.parentElement?this.getScoreItemFromChild(t.parentElement):null}emitChange(t){this.value!==t&&(this.options.onChange&&this.options.onChange(t),this.setValue(t))}clickListener(t){if(this.options.disabled||this.options.readonly)return;const e=t.target,a=t.offsetX,r=this.getScoreItemFromChild(e);if(r){let c=Number(r.dataset.score);this.options.allowHalf&&a<=c/2&&(c=c-.5);const u=this.options.clearable&&this.value===c?0:c;this.emitChange(u)}}registerListeners(){this.removeListeners(),this.getScoreItemEl().forEach(t=>{t.addEventListener("click",this.clickListener)})}removeListeners(){this.getScoreItemEl().forEach(t=>{t.removeEventListener("click",this.clickListener)})}getScoreItemEl(){return this.getContainer().querySelectorAll(`.${o.scoreItemClassName}`)}initCSSVars(){s.css(this.getContainer(),{"--starscore-size":l(this.options.size),"--starscore-color":this.options.color,"--starscore-void-color":this.options.voidColor,"--starscore-disabled-color":this.options.disabledColor,"--starscore-gutter":l(this.options.gutter)})}generateRadioHTML(t){return`
      <div class="${o.scoreItemClassName}" data-score="${t.score}">
        <span class="${o.scoreVoidIconClassName}">${this.getVoidIcon()}</span>
        <span class="${o.scoreIconClassName}" style="width:${t.width}">${this.getIcon()}</span>
      </div>
    `}generateRadioGroupHTML(){const t=this.scoreItems.reduce((r,c)=>(r+=`${this.generateRadioHTML(c)}`,r),""),e=this.options.disabled?"disabled":"",a=this.options.readonly?"readonly":"";return`
      <div class="${o.scoreWrapperClassName} ${e} ${a}">${t}</div>
    `}render(){const t=this.getContainer(),e=`${this.generateRadioGroupHTML()}`;s.addClass(t,o.containerClassName),t.innerHTML=e,this.registerListeners()}destory(){this.removeListeners()}getContainer(){if(this.container)return this.container;const t=typeof this.options.container=="string"?document.querySelector(`${this.options.container}`):this.options.container;return t&&(this.container=t),t}}const p=n=>new g(n),L="";i.Starscore=g,i.createStarscore=p,Object.defineProperty(i,Symbol.toStringTag,{value:"Module"})});
